---
- name: Ensure k8s root dir exists on master
  file:
    path: "{{ k8s_root_dir }}"
    state: directory
    mode: "0755"

- name: Copy k8s manifests to master
  copy:
    src: "{{ playbook_dir }}/../../k8s/"
    dest: "{{ k8s_root_dir }}/"
    mode: "0644"

- name: Apply base manifests (namespace, rbac, etc)
  command: kubectl apply -f {{ k8s_base_dir }}
  environment:
    KUBECONFIG: /etc/kubernetes/admin.conf

